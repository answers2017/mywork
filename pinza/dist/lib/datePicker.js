!function(l){"use strict";l.fn.datePicker=function(t){return this.each(function(){function e(){if(E=h.val(),l("#datePlugin").size()||l("body").append('<div id="datePlugin"></div>'),document.getElementsByTagName("body")[0].addEventListener("touchmove",n,!1),H.curdate||""==l.trim(E))g=parseInt(p.getFullYear())-parseInt(H.beginyear)+1,w=parseInt(p.getMonth())+1,k=parseInt(p.getDate()),I=parseInt(p.getHours())+1,D=parseInt(p.getMinutes())+1,x=parseInt(p.getSeconds());else{var t=null,e=null;("date"==H.theme||"datetime"==H.theme)&&(t=E.split(" ")[0],g=parseInt(t.split("-")[0]-parseInt(H.beginyear))+1,w=parseInt(t.split("-")[1]),k=parseInt(t.split("-")[2])),"datetime"==H.theme&&(e=E.split(" ")[1],I=parseInt(e.split(":")[0])+1,D=parseInt(e.split(":")[1])+1),"time"==H.theme&&(e=E,I=parseInt(e.split(":")[0])+1,D=parseInt(e.split(":")[1])+1),"month"==H.theme&&(t=E,g=parseInt(t.split("-")[0]-parseInt(H.beginyear))+1,w=parseInt(t.split("-")[1]))}l("#datePlugin").show(),o(),i(),l("#d-okBtn").on("click",function(){o(),document.getElementsByTagName("body")[0].removeEventListener("touchmove",n,!1);var t=l("#yearScroll li").eq(g).data("num"),e=l("#monthScroll li").eq(w).data("num"),a=l("#dayScroll li").eq(k).data("num"),i=l("#hourScroll li").eq(I).data("num"),d=l("#minuteScroll li").eq(D).data("num");h.val(l(".d-return-info").html()),l("#datePlugin").hide().html(""),H.callBack({y:t,M:e,d:a,h:i,m:d})}),l("#d-cancleBtn").on("click",function(){o(),l("#datePlugin").hide().html(""),document.getElementsByTagName("body")[0].removeEventListener("touchmove",n,!1)})}function n(l){l.preventDefault()}function a(l){return l%4==0&&l%100!=0||l%400==0?!0:!1}function i(){var t=' <div class="d-date-box"><div class="d-date-btns ui-border-b"><button class="d-btn" id="d-cancleBtn">取消</button><button class="d-btn" id="d-okBtn">确定</button></div><p class="d-date-info"><span class="d-day-info"></span><span class="d-return-info"></span></p></div>',e='<div class="d-date-wrap">';e+='<div class="d-date-mark ui-border-tb"></div>',e+='<div class="d-year-wrap d-date-cell" id="yearScroll"><ul></ul></div>',e+='<div class="d-month-wrap d-date-cell" id="monthScroll"><ul></ul></div>',e+='<div class="d-day-wrap d-date-cell" id="dayScroll"><ul></ul></div>',e+="</div>";var n='<div class="d-date-wrap d-time-wrap">';n+='<div class="d-date-mark"></div>',n+='<div class="d-hour-wrap d-date-cell" id="hourScroll"><ul></ul></div>',n+='<div class="d-minute-wrap d-date-cell" id="minuteScroll"><ul></ul></div>',n+="</div>";var a='<div class="d-date-wrap">';switch(a+='<div class="d-date-mark"></div>',a+='<div class="d-year-wrap d-date-cell" style="width:50%" id="yearScroll"><ul></ul></div>',a+='<div class="d-month-wrap d-date-cell" style="width:50%" id="monthScroll"><ul></ul></div>',a+="</div>",l("#datePlugin").html(t),H.theme){case"date":l(".d-date-box").append(e),r(),c(),u(H.monthDay[w-1]);break;case"datetime":l(".d-date-box").append(e),l(".d-date-box").append(n),r(),c(),u(H.monthDay[w-1]),s(),m();break;case"time":l(".d-date-box").append(n),s(),m();break;case"month":l(".d-date-box").append(a),r(),c();break;default:l(".d-date-box").append(e),r(),c(),u(H.monthDay[w-1])}d()}function d(){var t=l("#yearScroll li").eq(g).data("num"),e=l("#monthScroll li").eq(w).data("num"),n=l("#dayScroll li").eq(k).data("num"),a=l("#hourScroll li").eq(I).data("num"),i=l("#minuteScroll li").eq(D).data("num"),d=new Date(t+"-"+e+"-"+n);switch(H.theme){case"date":l(".d-day-info").html(H.days[d.getDay()]+"&nbsp;"),l(".d-return-info").html(t+"-"+e+"-"+n);break;case"datetime":l(".d-day-info").html(H.days[d.getDay()]+"&nbsp;"),l(".d-return-info").html(t+"-"+e+"-"+n+" "+a+":"+i);break;case"time":l(".d-return-info").html(a+":"+i);break;case"month":l(".d-return-info").html(t+"-"+e);break;default:l(".d-day-info").html(H.days[d.getDay()]+"&nbsp;"),l(".d-return-info").html(t+"-"+e+"-"+n)}}function o(){var l=[f,v,y,b,S];l.forEach(function(l){null!=l&&(l.destroy(),l=null)})}function r(){function t(l){var t=Math.floor(-l.y/H.liH);g=t+1,H.monthDay[1]=a(parseInt(e.find("li").eq(g).data("num")))?29:28,2==w&&"month"!=H.theme&&u(H.monthDay[w-1]),d()}for(var e=l("#yearScroll"),n=H.endyear-H.beginyear,i="<li></li>",o=0;n>=o;o++)i+="<li data-num="+(H.beginyear+o)+">"+(H.beginyear+o)+"年</li>";e.find("ul").html(i).append("<li></li>"),f=new iScroll("yearScroll",l.extend(!0,{},H.scrollOpt,{onScrollEnd:function(){t(this)}})),f.scrollTo(0,-(g-1)*H.liH)}function c(){function t(l){console.log("month");var t=Math.floor(-l.y/H.liH),e=H.monthDay[t];w=t+1,"month"!=H.theme&&u(e),d()}for(var e=l("#monthScroll"),n="<li></li>",a=1;12>=a;a++)n+=10>a?'<li data-num="0'+a+'">0'+a+"月</li>":'<li data-num="'+a+'">'+a+"月</li>";e.find("ul").html(n).append("<li></li>"),v=new iScroll("monthScroll",l.extend(!0,{},H.scrollOpt,{onScrollEnd:function(){t(this)}})),v.scrollTo(0,-(w-1)*H.liH)}function u(t){function e(l){k=Math.floor(-l.y/H.liH)+1,d()}for(var n=l("#dayScroll"),a="<li></li>",i=1;t>=i;i++)a+=10>i?'<li data-num="0'+i+'">0'+i+"日</li>":'<li data-num="'+i+'">'+i+"日</li>";n.find("ul").html(a).append("<li></li>"),y=new iScroll("dayScroll",l.extend(!0,{},H.scrollOpt,{onScrollEnd:function(){e(this)}})),k>H.monthDay[w-1]&&(k=1),y.scrollTo(0,-(k-1)*H.liH)}function s(){function t(l){I=Math.floor(-l.y/H.liH)+1,d()}for(var e=l("#hourScroll"),n="<li></li>",a=H.beginhour;a<=H.endhour;a++)n+=10>a?'<li data-num="0'+a+'">0'+a+"时</li>":'<li data-num="'+a+'">'+a+"时</li>";e.find("ul").html(n).append("<li></li>"),b=new iScroll("hourScroll",l.extend(!0,{},H.scrollOpt,{onScrollEnd:function(){t(this)}})),b.scrollTo(0,-(I-1)*H.liH)}function m(){function t(l){D=Math.floor(-l.y/H.liH)+1,d()}for(var e=l("#minuteScroll"),n="<li></li>",a=0;59>=a;a++)n+=10>a?'<li data-num="0'+a+'">0'+a+"分</li>":'<li data-num="'+a+'">'+a+"分</li>";e.find("ul").html(n).append("<li></li>"),S=new iScroll("minuteScroll",l.extend(!0,{},H.scrollOpt,{onScrollEnd:function(){t(this)}})),S.scrollTo(0,-(D-1)*H.liH)}var h=l(this),p=(l(this).is("input"),new Date),f=null,v=null,y=null,b=null,S=null,g=null,w=null,k=null,I=null,D=null,x=null,E=null;l.fn.datePicker.defaultOptions={beginyear:2010,endyear:2020,monthDay:[31,28,31,30,31,30,31,31,30,31,30,31],days:["周日","周一","周二","周三","周四","周五","周六"],beginhour:0,endhour:23,beginminute:0,endminute:59,curdate:!1,liH:40,theme:"date",mode:null,event:"click",show:!0,scrollOpt:{snap:"li",checkDOMChanges:!0,vScrollbar:!1,hScrollbar:!1,hScroll:!1},callBack:function(){}};var H=l.extend(!0,{},l.fn.datePicker.defaultOptions,t);H.show?h.on(H.event,function(){e()}):h.off("click")})}}("undefined"!=typeof Zepto?Zepto:jQuery);